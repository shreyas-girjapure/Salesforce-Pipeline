# This is a basic workflow to help you get started with Actions

name: Test Flow

on:
  push:
    branches: [master]
  pull_request:
    branches: [master]

  workflow_dispatch:

jobs:
  build:
    runs-on: ubuntu-latest

    steps:
      - name: Checkout repository
        uses: actions/checkout@v2
        with:
          fetch-depth: 2
      - name: Run a one-line script
        run: echo Hello, world!
      - name: "Install Salesforce CLI"
        run: |
          wget https://developer.salesforce.com/media/salesforce-cli/sfdx/channels/stable/sfdx-linux-x64.tar.xz
          mkdir ~/sfdx
          tar xJf sfdx-linux-x64.tar.xz -C ~/sfdx --strip-components 1
          echo "$HOME/sfdx/bin" >> $GITHUB_PATH
          ~/sfdx/bin/sfdx version
      #Install Salesforce Plugin
      - name: Install delta plugin
        if: success()
        run: echo y | sfdx plugins:install sfdx-git-delta           
      #Test diff 
      - name: Delta calculate
        if: success()
        run: |
          git log --oneline -n 3
          ANOTHER=${{toJSON(github)}}
          echo "$ANOTHER"